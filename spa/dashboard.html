<script>
    var chart;
    var newChart;
    var old_html;
    var goal = {};
    newChart = function(fk_kids, name) {
        $.ajax({
            url: domain+'/api/goal/'+fk_kids,
            type: 'GET',
            contentType : "application/x-www-form-urlencoded; charset=UTF-8",
            beforeSend: function (xhr) {
                xhr.setRequestHeader ("Authorization", jwt);
            },
            success: function(result) {
                goal.content = result[0].content;
                goal.goal_cost = result[0].goal_cost;
                goal.now_cost = result[0].now_cost;
                goal.remain = (goal.goal_cost < goal.now_cost) ? 0 : goal.goal_cost - goal.now_cost;

                $('#insertChart').append( old_html.replace('id="chart"', 'id="chart'+fk_kids+'"')
                        .replace('nameHead', name)
                        .replace('now_cost', goal.now_cost)
                        .replace('goal_cost', goal.goal_cost)
                        .replace('remain_cost', goal.remain ));

                chart = new Morris.Donut({
                    element: "chart" +fk_kids,
                    data: [{
                        label: "현재 저축량  ",
                        value: goal.now_cost
                    }, {
                        label: "남은 저축량  ",
                        value: goal.remain
                    }],
                    formatter: function (x) {
                        return "￦" + x.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g, "$1,");
                    },
                    resize: true
                });
            },
            error: function() {
                alert("오류, 목표 정보를 받아오는데 실패하였습니다.");
            }

        });
    };



    $.ajax({       // Login

        url: './spa/chartpanel.html',
        type: 'GET',
        contentType : "application/x-www-form-urlencoded; charset=UTF-8",
        success: function(html) {
            old_html = html;
            for(var i=0 ; i<child.length ; i++){
                newChart(child[i].fk_kids, child[i].name);
            }
        },
        error: function() {
            alert('chartpanel불러오기 실패');
        }

    });



//    var decimal_data = [];
//    for (var x = 0; x <= 360; x += 10) {
//        decimal_data.push({
//            x: x,
//            y: 10
//        });
//    }
//    window.m = Morris.Line({
//        element: 'flot-line-chart',
//        data: decimal_data,
//        xkey: 'x',
//        ykeys: ['y'],
//        labels: ['sin(x)'],
//        parseTime: false,
//        goals: [-1, 0, 1]
//    });

</script>

<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">
            전체 요약 정보 <small>내 자녀정보를 한눈에</small>
        </h1>
    </div>
</div>

<!-- 차트 페널 들어갈 자리 -->
<div id="insertChart">
</div>


<!--<div class="row">-->
    <!--<div class="col-lg-12">-->
        <!--<div class="panel panel-primary">-->
            <!--<div class="panel-heading">-->
                <!--<h3 class="panel-title"><i class="fa fa-krw fa-fw"></i> 저축 정보</h3>-->
            <!--</div>-->
            <!--<div class="panel-body">-->
                <!--<div class="container-fluid">-->
                    <!--&lt;!&ndash;<div id="morris-donut-chart"></div>&ndash;&gt;-->

                    <!--<div class="flot-chart-content" id="chart1" style="padding: 0px; position: relative;></div>-->
                <!--</div>-->
                <!--<div class="row">-->
                    <!--<div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">-->
                        <!--<div class="panel panel-info">-->
                            <!--<div class="panel-heading">-->
                                <!--<div class="saving saving-title">-->
                                    <!--<p>목표 저축량</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="panel-body">-->
                                <!--<div class="saving saving-body">-->
                                    <!--<spen class="fa fa-krw"></spen><b>50,000</b>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">-->
                        <!--<div class="panel panel-info">-->
                            <!--<div class="panel-heading">-->
                                <!--<div class="saving saving-title">-->
                                    <!--<p>현재 저축량</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="panel-body">-->
                                <!--<div class="saving saving-body">-->
                                    <!--<spen class="fa fa-krw"></spen><b>20,000</b>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->

                    <!--<div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">-->
                        <!--<div class="panel panel-info">-->
                            <!--<div class="panel-heading">-->
                                <!--<div class="saving saving-title">-->
                                    <!--<p>남은 저축량</p>-->
                                <!--</div>-->
                            <!--</div>-->
                            <!--<div class="panel-body">-->
                                <!--<div class="saving saving-body">-->
                                    <!--<spen class="fa fa-krw"></spen><b>30,000</b>-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->

                <!--<div class="text-right">-->
                    <!--<a href="#">자세 보기 <i class="fa fa-arrow-circle-right"></i></a>-->
                <!--</div>-->

            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
<!--</div>-->


<!--<div class="row">-->
    <!--<div class="col-sm-12 col-md-4 col-lg-4">-->
        <!--<div class="panel panel-primary">-->
            <!--<div class="panel-heading">-->
                <!--<h3 class="panel-title"><i class="fa fa-github-alt fa-fw"></i> 펫 상태</h3>-->
            <!--</div>-->
            <!--<div class="panel-body">-->
                <!--<img src="./image/coinpet.jpeg" style="max-width: 100%; height: auto;">-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->

    <!--<div class="col-sm-12 col-md-4 col-lg-4">-->
        <!--<div class="panel panel-primary">-->
            <!--<div class="panel-heading">-->
                <!--<h3 class="panel-title"><i class="fa fa-list fa-fw"></i> 펫 활동</h3>-->
            <!--</div>-->
            <!--<div class="panel-body">-->
                <!--<ul class="list-group">-->
                    <!--<li class="list-group-item">-->
                        <!--<span class="badge">방금 전</span>-->
                        <!--<i class="fa fa-fw fa-smile-o"></i> '창우'가 인사를 받아줘서 기분이 좋아졌어요-->
                    <!--</li>-->
                    <!--<li class="list-group-item">-->
                        <!--<span class="badge">방금 전</span>-->
                        <!--<i class="fa fa-fw fa-calendar"></i> 펫이 인사를 했어요!-->
                    <!--</li>-->
                    <!--<li class="list-group-item">-->
                        <!--<span class="badge">5분 전</span>-->
                        <!--<i class="fa fa-fw fa-frown-o"></i> 우울증함이 느껴져요...-->
                    <!--</li>-->
                    <!--<li class="list-group-item">-->
                        <!--<span class="badge">30분 전</span>-->
                        <!--<i class="fa fa-fw fa-sun-o"></i> 펫이 일어났어요.-->
                    <!--</li>-->
                    <!--<li class="list-group-item">-->
                        <!--<span class="badge">10시간 전</span>-->
                        <!--<i class="fa fa-fw fa-hotel"></i> 펫이 잠들었어요. Zzz...-->
                    <!--</li>-->
                    <!--<li class="list-group-item">-->
                        <!--<span class="badge">어제</span>-->
                        <!--<i class="fa fa-fw fa-book"></i> 독서는 가장 좋아하는 취미입니다!!-->
                    <!--</li>-->
                <!--</ul>-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->

    <!--<div class="col-sm-12 col-md-4 col-lg-4">-->
        <!--<div class="panel panel-primary">-->
            <!--<div class="panel-heading">-->
                <!--<h3 class="panel-title"><i class="fa fa-github-alt fa-fw"></i> 펫 상태</h3>-->
            <!--</div>-->
            <!--<div class="panel-body">-->
                <!--<img src="./image/coinpet.jpeg" style="max-width: 100%; height: auto;">-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
<!--</div>-->